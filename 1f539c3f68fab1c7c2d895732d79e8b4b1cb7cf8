{
  "comments": [
    {
      "key": {
        "uuid": "a90912bd_1cbc3e77",
        "filename": "ci-scripts/container-push/container-push.yml",
        "patchSetId": 56
      },
      "lineNbr": 56,
      "author": {
        "id": 192
      },
      "writtenOn": "2020-03-06T15:50:12Z",
      "side": 1,
      "message": "(I am not against this change it looks good just trying to understand)\n\nwas this somehow necessary for the integration pipeline goal? Or is it just unrelated improvement? As far as I can see it was already including stage-info, just here you are assigning it to stage_info variable.\n\n\n[EDIT]: yes it is relevant/needed... the stage_info variable is used in many places like the list of containers stage_info.containers.images",
      "revId": "1f539c3f68fab1c7c2d895732d79e8b4b1cb7cf8",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a1cca97f_d1e80c0b",
        "filename": "ci-scripts/container-push/container-push.yml",
        "patchSetId": 56
      },
      "lineNbr": 56,
      "author": {
        "id": 63
      },
      "writtenOn": "2020-03-06T17:26:27Z",
      "side": 1,
      "message": "The integration jobs have one additional test, they need to verify that we are not leaking anything that looks like a password in the logs.\nWithout no_logs here, the entire content of that file/variable is dumped, and since they contain the word \"password\" they fail the job.\nWe can either use this, or try to make that check a bit smarter",
      "parentUuid": "a90912bd_1cbc3e77",
      "revId": "1f539c3f68fab1c7c2d895732d79e8b4b1cb7cf8",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "adcd4ca8_d08531d4",
        "filename": "ci-scripts/container-push/roles/containers-promote/tasks/check_set_ppc_manifests.yml",
        "patchSetId": 56
      },
      "lineNbr": 30,
      "author": {
        "id": 192
      },
      "writtenOn": "2020-03-06T15:50:12Z",
      "side": 1,
      "message": "s that",
      "range": {
        "startLine": 30,
        "startChar": 51,
        "endLine": 30,
        "endChar": 56
      },
      "revId": "1f539c3f68fab1c7c2d895732d79e8b4b1cb7cf8",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "949caa8a_27153234",
        "filename": "ci-scripts/container-push/roles/containers-promote/tasks/check_set_ppc_manifests.yml",
        "patchSetId": 56
      },
      "lineNbr": 30,
      "author": {
        "id": 63
      },
      "writtenOn": "2020-03-06T17:41:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "adcd4ca8_d08531d4",
      "range": {
        "startLine": 30,
        "startChar": 51,
        "endLine": 30,
        "endChar": 56
      },
      "revId": "1f539c3f68fab1c7c2d895732d79e8b4b1cb7cf8",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "708793cd_4984960e",
        "filename": "ci-scripts/container-push/roles/containers-promote/tasks/check_set_ppc_manifests.yml",
        "patchSetId": 56
      },
      "lineNbr": 32,
      "author": {
        "id": 192
      },
      "writtenOn": "2020-03-06T15:50:12Z",
      "side": 1,
      "message": "Continuing \n\n(or somesuch please add)\n\n[EDIT]: why not just add the pulled_ppc here too and remove the next one unnecessary\n\n\"Failed to pull ppc containers - debug pulled_ppc {{ pulled_ppc }}\" should do it?",
      "revId": "1f539c3f68fab1c7c2d895732d79e8b4b1cb7cf8",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "62e31a1b_c8bc80b9",
        "filename": "ci-scripts/container-push/roles/containers-promote/tasks/check_set_ppc_manifests.yml",
        "patchSetId": 56
      },
      "lineNbr": 32,
      "author": {
        "id": 63
      },
      "writtenOn": "2020-03-06T17:26:27Z",
      "side": 1,
      "message": "It\u0027s probably better to discuss in a meeting, but I\u0027ll try to summarize.\nI needed to remove the ignore_errors because when I changed this the first time, I made an error, so I was not able to distinguish anymore what was my error and what was an error in the pull.\nThis is why I think ignore_errors in an antipattern and should be banned ....\nIn this way when the task fails I can run some additional task trying to understand why.\nIn this case we already know how to identify a case of failure. if results is not in pulled_ppc, it means that the task was not even run correctly and debug will be in the ansible exception, if it fails for any other reason, the failure will be ignored (THe original intention) but we dump the debug information to really be sure taht that is the problem)\nIf the task will ever fail again with something  that is not know, we\u0027ll have the debug info, and we\u0027ll be able to add another Fail task with another reason to stop execution.",
      "parentUuid": "708793cd_4984960e",
      "revId": "1f539c3f68fab1c7c2d895732d79e8b4b1cb7cf8",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "87c5c320_12b26cf7",
        "filename": "ci-scripts/container-push/roles/containers-promote/tasks/check_set_ppc_manifests.yml",
        "patchSetId": 56
      },
      "lineNbr": 65,
      "author": {
        "id": 192
      },
      "writtenOn": "2020-03-06T15:50:12Z",
      "side": 1,
      "message": "is that correct? Should it be !\u003d []\n\ni.e. when there is such a thing as \u0027failed\u0027 in the attributes is what we want.",
      "revId": "1f539c3f68fab1c7c2d895732d79e8b4b1cb7cf8",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "22be7318_532df4d1",
        "filename": "ci-scripts/container-push/roles/containers-promote/tasks/check_set_ppc_manifests.yml",
        "patchSetId": 56
      },
      "lineNbr": 65,
      "author": {
        "id": 63
      },
      "writtenOn": "2020-03-06T17:41:01Z",
      "side": 1,
      "message": "This pipeline of filters can be read as\n- (pulled_ppc.results) from pulled_ppc take the list of results of the loop\n\nat this point in the pipeline we have a list of task execution results: [{...}, {...}]\n\n- (|map(attribute\u003d\u0027failed\u0027)from each result in the list extract the attribute \u0027failed\u0027 which is the boolean value that reports True if the task in the loop failed\n\nat this point in the pipeline we have a list of booleans: [True, True, False, True]\n\n- (|select) select is a lazy filter (it\u0027s a generator) and without parameters, it return the number of True elements in the list\n\nat this point in the pipeline we have a \u003cgenerator object select: [True, True, False, True]\n\n- (|list) is there to force the lazy generator to generate an actual list\n\nat this point in the pipeline we have [True, True, True]\n\nNOW, if the list is not empty it means that some results failed with failed\u003dTrue.\nIf it\u0027s empty means that none of the results had failed\u003dTrue.",
      "parentUuid": "87c5c320_12b26cf7",
      "revId": "1f539c3f68fab1c7c2d895732d79e8b4b1cb7cf8",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    }
  ]
}