{
  "comments": [
    {
      "key": {
        "uuid": "8c7558f7_5f4d8615",
        "filename": "ci-scripts/dlrnapi_promoter/test_promoter_functional.py",
        "patchSetId": 18
      },
      "lineNbr": 120,
      "author": {
        "id": 192
      },
      "writtenOn": "2020-09-14T11:03:40Z",
      "side": 1,
      "message": "been poking at failing py36 for most of today and spinning... adding a note for the call later.\n\nhttps://logserver.rdoproject.org/19/28019/18/check/tox-py36-ci-config/09017d8/tox/reports.html\n        * ci-scripts/dlrnapi_promoter/test_promoter_functional.py::test_promote_containers[containers_single]::setup\n        * ERROR    promoter:config.py:84 No constructor for attribute promotions\nERROR    promoter:config.py:172 No attribute promotions in config\nDEBUG    promoter:config.py:88 Running constructor for attribute dlrnauth_password\nERROR    promoter:config.py:662 Validation Error: Missing promotions section\nERROR    promoter:config.py:544 Error in configuration\n\n\n\n\n541         config \u003d self.config_class(**layers)$                                  \n542         import pdb; pdb.set_trace()$                                           \n543         if not self.validate(config, checks\u003dvalidate):$                        \n544             self.log.error(\"Error in configuration\")$                          \n545             raise ConfigError$                                                 \n546 $                                                                              \n547         return config$                                                         \nconfig.py                                                                               540,0-1        81%\n\n\n\n\n*\u003d* 12:51:20 *\u003d*\u003d*\u003d \" [m@192 ci-config]$ python -m pytest  ./ci-scripts/dlrnapi_promoter/test_promoter_functional.py::test_promote_containers\"\n(Pdb) config.promotions\n*** AttributeError: No setting \u0027promotions\u0027 found\n\n\n\n\n\n        * (Pdb) layers\n{\u0027global_defaults\u0027: {\u0027log_level\u0027: \u0027INFO\u0027, \u0027allowed_clients\u0027: \u0027registries_client,qcow_client,dlrn_client\u0027, \u0027global_config_root\u0027: \u0027config_environments\u0027, \u0027environment_config_root\u0027: \u0027config_environments/staging\u0027, \u0027dry_run\u0027: False, \u0027distro\u0027: \u0027{{ distro_name }}{{ distro_version }}\u0027, \u0027scenes\u0027: [\u0027dlrn\u0027, \u0027overcloud_images\u0027, \u0027containers\u0027, \u0027registries\u0027], \u0027db_data_file\u0027: \u0027single-pipeline.yaml\u0027, \u0027stage_config_file\u0027: \u0027stage-config.yaml\u0027, \u0027stage_info_file\u0027: \u0027/tmp/stage-info.yaml\u0027, \u0027git_root\u0027: \u0027/home/m/Documents/WORK/NewEclipsey/Github/Tuskar/ci-config\u0027, \u0027script_root\u0027: \u0027/home/m/Documents/WORK/NewEclipsey/Github/Tuskar/ci-config/ci-scripts/dlrnapi_promoter\u0027}, \u0027environment_defaults\u0027: {\u0027release\u0027: \u0027master\u0027, \u0027distro_name\u0027: \u0027centos\u0027, \u0027distro_version\u0027: \u00278\u0027, \u0027dlrnauth_username\u0027: \u0027ciuser\u0027, \u0027manifest_push\u0027: \u0027true\u0027, \u0027target_registries_push\u0027: \u0027true\u0027, \u0027latest_hashes_count\u0027: \u002710\u0027, \u0027log_level\u0027: \u0027DEBUG\u0027, \u0027dlrn_api_host\u0027: \u0027localhost\u0027, \u0027dlrn_api_port\u0027: 58080, \u0027dlrn_api_scheme\u0027: \u0027http\u0027, \u0027dlrn_api_endpoint\u0027: \u0027\u0027, \u0027containers_list_base_url\u0027: \u0027https://opendev.org/openstack/tripleo-common/raw/commit/\u0027, \u0027containers_list_path\u0027: \u0027container-images/overcloud_containers.yaml.j2\u0027, \u0027repo_url\u0027: \u0027https://{{ dlrn_api_host }}/{{ distro }}-{{ release  }}\u0027, \u0027overcloud_images\u0027: {\u0027qcow_servers\u0027: {\u0027local\u0027: {\u0027user\u0027: \u0027user\u0027, \u0027host\u0027: \u0027localhost\u0027, \u0027root\u0027: \u0027overcloud_images/\u0027, \u0027key\u0027: \u0027sample_key\u0027}}}, \u0027default_qcow_server\u0027: \u0027local\u0027, \u0027stage_info_path\u0027: \u0027/tmp/stage-info.yaml\u0027, \u0027dry_run\u0027: False, \u0027promoter_user\u0027: \u0027promoter\u0027, \u0027scenes\u0027: [\u0027registries\u0027, \u0027dlrn\u0027, \u0027containers\u0027, \u0027overcloud_images\u0027], \u0027stage_root\u0027: \u0027/tmp/promoter-staging/\u0027, \u0027log_file\u0027: \u0027~/web/promoter_logs/{{ distro }}_{{ release }}.log\u0027, \u0027registries\u0027: [{\u0027type\u0027: \u0027source\u0027, \u0027name\u0027: \u0027local-source-registry\u0027, \u0027port\u0027: 6000, \u0027secure\u0027: False, \u0027schema\u0027: \u0027v2_s2\u0027}, {\u0027type\u0027: \u0027target\u0027, \u0027name\u0027: \u0027local-target-registry-1\u0027, \u0027port\u0027: 6500, \u0027secure\u0027: False, \u0027schema\u0027: \u0027v2_s2\u0027}], \u0027containers\u0027: {\u0027images-suffix\u0027: [\u0027nova-compute\u0027, \u0027neutron-server\u0027], \u0027namespace_prefix\u0027: \u0027tripleo\u0027, \u0027root\u0027: \u0027containers/\u0027, \u0027list_base_url\u0027: \u0027tripleo-common\u0027, \u0027containers_list_base\u0027: \u0027tripleo-common\u0027, \u0027list_path\u0027: None, \u0027containers_list_exclude_config\u0027: \u0027/tmp/promoter-staging/containers/build-containers-main.yaml\u0027, \u0027list_exclude_config\u0027: \u0027\"https://opendev.org/openstack/tripleo-ci/raw/branch/master/roles/build-containers/vars/main.yaml\"\\n\u0027}, \u0027dlrn\u0027: {\u0027components\u0027: [\u0027tripleo\u0027, \u0027nova\u0027, \u0027neutron\u0027], \u0027promotion_target\u0027: \u0027tripleo-ci-staging-promoted\u0027, \u0027server\u0027: {\u0027username\u0027: \u0027ciuser\u0027, \u0027password\u0027: \u0027dlrnapi_password00\u0027, \u0027host\u0027: \u0027localhost\u0027, \u0027port\u0027: 58080, \u0027root\u0027: \u0027dlrn/\u0027, \u0027repo_root\u0027: \u0027data/repos/\u0027, \u0027db_file\u0027: \u0027commits.sqlite\u0027, \u0027db_data_file\u0027: \u0027single-pipeline.yaml\u0027}}}, \u0027release_settings\u0027: {\u0027main\u0027: {\u0027release\u0027: \u0027master\u0027, \u0027distro_name\u0027: \u0027centos\u0027, \u0027distro_version\u0027: 8, \u0027promotions\u0027: {\u0027current-tripleo\u0027: {\u0027candidate_label\u0027: \u0027tripleo-ci-testing\u0027, \u0027criteria\u0027: [\u0027periodic-tripleo-centos-8-master-containers-build-push\u0027, \u0027periodic-tripleo-centos-8-buildimage-overcloud-full-master\u0027, \u0027periodic-tripleo-centos-8-buildimage-ironic-python-agent-master\u0027, \u0027periodic-tripleo-ci-centos-8-standalone-master\u0027, \u0027periodic-tripleo-ci-centos-8-scenario001-standalone-master\u0027, \u0027periodic-tripleo-ci-centos-8-scenario002-standalone-master\u0027, \u0027periodic-tripleo-ci-centos-8-scenario003-standalone-master\u0027, \u0027periodic-tripleo-ci-centos-8-scenario004-standalone-master\u0027, \u0027periodic-tripleo-ci-centos-8-scenario007-standalone-master\u0027, \u0027periodic-tripleo-ci-centos-8-undercloud-containers-master\u0027, \u0027periodic-tripleo-ci-centos-8-multinode-1ctlr-featureset010-master\u0027, \u0027periodic-tripleo-ci-centos-8-containers-undercloud-minion-master\u0027, \u0027periodic-tripleo-ci-centos-8-scenario000-multinode-oooq-container-updates-master\u0027, \u0027periodic-tripleo-ci-centos-8-ovb-3ctlr_1comp-featureset001-master\u0027]}, \u0027current-tripleo-rdo\u0027: {\u0027candidate_label\u0027: \u0027current-tripleo\u0027, \u0027criteria\u0027: [\u0027weirdo-master-promote-packstack-scenario001\u0027, \u0027weirdo-master-promote-packstack-scenario002\u0027, \u0027weirdo-master-promote-packstack-scenario003\u0027, \u0027weirdo-master-promote-puppet-openstack-scenario001\u0027, \u0027weirdo-master-promote-puppet-openstack-scenario002\u0027, \u0027weirdo-master-promote-puppet-openstack-scenario003\u0027, \u0027weirdo-master-promote-puppet-openstack-scenario004\u0027]}}}}}\n\n*\u003d* 13:16:40 *\u003d*\u003d*\u003d \" \" \n\n        * (Pdb) release_settings_path\n\u0027CentOS-8/master.yaml\u0027\n*\u003d* 13:50:47 *\u003d*\u003d*\u003d \" \" \n\n        * (Pdb) self.config_class\n\u003cclass \u0027stage_config.StageConfig\u0027\u003e",
      "revId": "4c68f31f76dcacbef9454a9fde138e1139712e87",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    }
  ]
}