---
- name: assure service user exists
  user:
    name: centos

- name: Copy multinode monitoring parser script
  copy:
    src: multinode.py
    dest: ~/multinode.py

- name: Copy OVB monitoring parser script
  copy:
    src: ovb_tracking.py
    dest: ~/ovb_tracking.py

- name: Create cron job to run multinode parser for InfluxDB and Grafana
  cron:
    name: 'script for pulling monitoring data from multinode jobs'
    minute: 0
    job: '/usr/bin/python ~/multinode.py -c ~/creds'

- name: Create cron job to run multinode parser for InfluxDB and Grafana
  cron:
    name: 'script for pulling monitoring data from OVB jobs'
    minute: 30
    job: '/usr/bin/python ~/ovb_tracking.py -c ~/creds'

- name: Create cron job for removing multinode and OVB db every day
  cron:
    name: 'script for cleaning up databse file regularly'
    minute: 30
    hour: 03
    job: 'rm -f ~/multinode_db; rm -f ~/ovb_db; '
