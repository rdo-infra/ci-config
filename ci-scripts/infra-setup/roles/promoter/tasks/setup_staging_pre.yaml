# Good idempotency: ssh_keypair is filled with proper information even
# if the key is already there
- openssh_keypair:
    path: "{{ ansible_user_dir }}/.ssh/id_rsa"
    size: 1024
  register: ssh_keypair

- copy:
    content: "{{ ssh_keypair.public_key }}"
    dest: "{{ ansible_user_dir }}/.ssh/authorized_keys"

