{
  "comments": [
    {
      "key": {
        "uuid": "cf168986_e774fdfe",
        "filename": "ci-scripts/container-push/container-push.yml",
        "patchSetId": 15
      },
      "lineNbr": 21,
      "author": {
        "id": 502
      },
      "writtenOn": "2019-12-06T17:14:16Z",
      "side": 1,
      "message": "hmm that one is new to me",
      "range": {
        "startLine": 21,
        "startChar": 17,
        "endLine": 21,
        "endChar": 22
      },
      "revId": "d67bae8dc188351a05d4d141b5a1c125a89a2a36",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0cc2521a_62422310",
        "filename": "ci-scripts/container-push/roles/containers-promote/tasks/registry-push.yml",
        "patchSetId": 15
      },
      "lineNbr": 81,
      "author": {
        "id": 502
      },
      "writtenOn": "2019-12-06T17:14:16Z",
      "side": 1,
      "message": "why s1 is default? will quay.io be the primary registry?",
      "range": {
        "startLine": 81,
        "startChar": 32,
        "endLine": 81,
        "endChar": 37
      },
      "revId": "d67bae8dc188351a05d4d141b5a1c125a89a2a36",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ecce49d2_7bb6f2b8",
        "filename": "ci-scripts/container-push/roles/containers-promote/tasks/registry-push.yml",
        "patchSetId": 15
      },
      "lineNbr": 81,
      "author": {
        "id": 63
      },
      "writtenOn": "2019-12-06T17:30:33Z",
      "side": 1,
      "message": "No, but the default needs to be conservative.\nIf the registry is v2_s2 and it\u0027s not specified, with this default we\u0027ll just skip some actions\nIf the registry is v2_s1 and it\u0027s not specified, with the opposite default the tasks wil fail and promotion will too",
      "revId": "d67bae8dc188351a05d4d141b5a1c125a89a2a36",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7683a725_936091cb",
        "filename": "ci-scripts/container-push/roles/containers-promote/tasks/registry-push.yml",
        "patchSetId": 15
      },
      "lineNbr": 101,
      "author": {
        "id": 502
      },
      "writtenOn": "2019-12-06T17:14:16Z",
      "side": 1,
      "message": "same here, default only if quay.io is meant to be the primary registry",
      "range": {
        "startLine": 101,
        "startChar": 34,
        "endLine": 101,
        "endChar": 39
      },
      "revId": "d67bae8dc188351a05d4d141b5a1c125a89a2a36",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bf2ac611_d7c841de",
        "filename": "ci-scripts/container-push/roles/containers-promote/tasks/registry-push.yml",
        "patchSetId": 15
      },
      "lineNbr": 101,
      "author": {
        "id": 63
      },
      "writtenOn": "2019-12-06T17:30:33Z",
      "side": 1,
      "message": "Same as above",
      "revId": "d67bae8dc188351a05d4d141b5a1c125a89a2a36",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9b0145a3_f8a9173b",
        "filename": "ci-scripts/dlrnapi_promoter/config/RedHat-8/master.ini",
        "patchSetId": 15
      },
      "lineNbr": 11,
      "author": {
        "id": 502
      },
      "writtenOn": "2019-12-06T17:14:16Z",
      "side": 1,
      "message": "this is disabled in code with with this check https://github.com/openstack/tripleo-ci/blob/master/roles/build-containers/tasks/main.yaml#L199",
      "range": {
        "startLine": 11,
        "startChar": 24,
        "endLine": 11,
        "endChar": 29
      },
      "revId": "d67bae8dc188351a05d4d141b5a1c125a89a2a36",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "93d2f3d7_35074b78",
        "filename": "ci-scripts/dlrnapi_promoter/config/RedHat-8/master.ini",
        "patchSetId": 15
      },
      "lineNbr": 11,
      "author": {
        "id": 63
      },
      "writtenOn": "2019-12-06T17:30:33Z",
      "side": 1,
      "message": "Well these are two different phases. Even if the push is disabled at build time, the promoter can still upload whatever it wants. This prevents the promoter from pushing to any external registry",
      "revId": "d67bae8dc188351a05d4d141b5a1c125a89a2a36",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f12ba0e7_57537a1b",
        "filename": "ci-scripts/dlrnapi_promoter/config/RedHat-8/train.ini",
        "patchSetId": 15
      },
      "lineNbr": 11,
      "author": {
        "id": 502
      },
      "writtenOn": "2019-12-06T17:14:16Z",
      "side": 1,
      "message": "good to have this here\njust for the record, this also disables rhel pushing \nhttps://github.com/openstack/tripleo-ci/blob/master/roles/build-containers/tasks/main.yaml#L199",
      "range": {
        "startLine": 11,
        "startChar": 24,
        "endLine": 11,
        "endChar": 29
      },
      "revId": "d67bae8dc188351a05d4d141b5a1c125a89a2a36",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f2ee430b_fefeefe1",
        "filename": "ci-scripts/dlrnapi_promoter/tests/staging-setup/staging_environment.py",
        "patchSetId": 15
      },
      "lineNbr": 129,
      "author": {
        "id": 192
      },
      "writtenOn": "2019-12-09T10:42:21Z",
      "side": 1,
      "message": "maybe add a #TODO(improve tests) here and/or at https://review.rdoproject.org/r/#/c/23931/14/ci-scripts/dlrnapi_promoter/tests/staging-setup/stage-config-secure.yaml@19",
      "range": {
        "startLine": 129,
        "startChar": 34,
        "endLine": 129,
        "endChar": 44
      },
      "revId": "d67bae8dc188351a05d4d141b5a1c125a89a2a36",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "34363fc9_2fb18890",
        "filename": "ci-scripts/infra-setup/roles/promoter/defaults/main.yml",
        "patchSetId": 15
      },
      "lineNbr": 31,
      "author": {
        "id": 502
      },
      "writtenOn": "2019-12-06T17:14:16Z",
      "side": 1,
      "message": "_uploader suffix was to make it explicit",
      "range": {
        "startLine": 31,
        "startChar": 58,
        "endLine": 31,
        "endChar": 64
      },
      "revId": "d67bae8dc188351a05d4d141b5a1c125a89a2a36",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "881b5d46_f2d28e5f",
        "filename": "ci-scripts/infra-setup/roles/promoter/defaults/main.yml",
        "patchSetId": 15
      },
      "lineNbr": 31,
      "author": {
        "id": 63
      },
      "writtenOn": "2019-12-06T17:30:33Z",
      "side": 1,
      "message": "Yes, but doesn\u0027t work, because the promote-images.sh script doesn\u0027t specify any alternative key when connecting to the host. No configuration is present. So in the new server, the Qcow uploads were failing for missing keys. In the final server. this key must be the default, at least until we change the promote-images.sh to handle multiple keys.",
      "revId": "d67bae8dc188351a05d4d141b5a1c125a89a2a36",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    }
  ]
}