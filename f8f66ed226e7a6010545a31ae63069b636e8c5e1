{
  "comments": [
    {
      "key": {
        "uuid": "2c3dbde2_ff956ec3",
        "filename": "ci-scripts/container-push/container-push.yml",
        "patchSetId": 17
      },
      "lineNbr": 30,
      "author": {
        "id": 502
      },
      "writtenOn": "2019-09-19T17:14:53Z",
      "side": 1,
      "message": "rationale for this?",
      "range": {
        "startLine": 30,
        "startChar": 4,
        "endLine": 30,
        "endChar": 24
      },
      "revId": "f8f66ed226e7a6010545a31ae63069b636e8c5e1",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "892bae0d_06d363cb",
        "filename": "ci-scripts/container-push/container-push.yml",
        "patchSetId": 17
      },
      "lineNbr": 30,
      "author": {
        "id": 192
      },
      "writtenOn": "2019-09-20T08:13:18Z",
      "side": 1,
      "message": "we discussed having a switch which is off and we will enable it later. it also makes it easier if we need to \u0027revert\u0027\n\nit doesn\u0027t really make sense though, i mean, once we go live with it it will always be on and so not needed.",
      "parentUuid": "2c3dbde2_ff956ec3",
      "range": {
        "startLine": 30,
        "startChar": 4,
        "endLine": 30,
        "endChar": 24
      },
      "revId": "f8f66ed226e7a6010545a31ae63069b636e8c5e1",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4c1403b1_a7d70f36",
        "filename": "ci-scripts/container-push/container-push.yml",
        "patchSetId": 17
      },
      "lineNbr": 159,
      "author": {
        "id": 502
      },
      "writtenOn": "2019-09-19T17:14:53Z",
      "side": 1,
      "message": "this is not reflecting our design. We should push container:tag in addition to the new temporary manifest container:manifest, for example:\n- container:full_hash as the x86 image\n- container:full_hash_x86_64 as the x86_64 image\n- container:full_hash_ppc64le as the ppc64le image\nand \n- container:multi_arch_full_hash as the temporary manifest",
      "range": {
        "startLine": 159,
        "startChar": 9,
        "endLine": 159,
        "endChar": 33
      },
      "revId": "f8f66ed226e7a6010545a31ae63069b636e8c5e1",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ee75f1b_3b2b98a2",
        "filename": "ci-scripts/container-push/container-push.yml",
        "patchSetId": 17
      },
      "lineNbr": 159,
      "author": {
        "id": 192
      },
      "writtenOn": "2019-09-20T08:13:18Z",
      "side": 1,
      "message": "ack yeah this is the \u0027final\u0027 case i.e. where we are pushing the name:hash manifest. I will rework that to keep pushing the containers as usual for now.",
      "parentUuid": "4c1403b1_a7d70f36",
      "range": {
        "startLine": 159,
        "startChar": 9,
        "endLine": 159,
        "endChar": 33
      },
      "revId": "f8f66ed226e7a6010545a31ae63069b636e8c5e1",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4847e848_76bb9656",
        "filename": "ci-scripts/container-push/manifest-push.yml",
        "patchSetId": 17
      },
      "lineNbr": 39,
      "author": {
        "id": 502
      },
      "writtenOn": "2019-09-19T17:14:53Z",
      "side": 1,
      "message": "is this right? my local test says results is not a valid field in get_url",
      "range": {
        "startLine": 39,
        "startChar": 29,
        "endLine": 39,
        "endChar": 36
      },
      "revId": "f8f66ed226e7a6010545a31ae63069b636e8c5e1",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e68aa81f_8d9d6c40",
        "filename": "ci-scripts/container-push/manifest-push.yml",
        "patchSetId": 17
      },
      "lineNbr": 39,
      "author": {
        "id": 192
      },
      "writtenOn": "2019-09-20T08:13:18Z",
      "side": 1,
      "message": "yes, you can see it running here for example http://logs.rdoproject.org/02/22002/15/check/rdo-tox-molecule/29061fb/tox/reports.html \n\n(more recent logs are failing on the tasks in main.yaml and didn\u0027t get that far)",
      "parentUuid": "4847e848_76bb9656",
      "range": {
        "startLine": 39,
        "startChar": 29,
        "endLine": 39,
        "endChar": 36
      },
      "revId": "f8f66ed226e7a6010545a31ae63069b636e8c5e1",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b927782a_620f48e6",
        "filename": "ci-scripts/container-push/manifest-push.yml",
        "patchSetId": 17
      },
      "lineNbr": 82,
      "author": {
        "id": 502
      },
      "writtenOn": "2019-09-19T17:14:53Z",
      "side": 1,
      "message": "no, please no. This does not reflect our design.\n\nWe agreed to create a temporary manifest for now that does not override the current image:tag.\nSo we should push image:tag plus the temporary manifest image:manifest, where:\n- tag\u003dfull_hash and tag\u003dfull_hash_x86_64 for x86\n- tag\u003dfull_hash_ppc64le for ppc64le\n- manifest\u003dmulti_arch_full_hash\n\nso we end up with container :\n- centos-binary-blah:ffffffffffffffff\n- centos-binary-blah:ffffffffffffffff_x86_64\n- centos-binary-blah:ffffffffffffffff_ppc64le\n- centos-binary-blah:multi_arch_fffffffffffffff\n\nwhere\n- tag\u003dfull_hash\u003dffffffffffffffff\n- manifest\u003dmulti_arch_ffffffffffffffff\n\n\nIn other words we\u0027ll push manifest w/ a temp name \"multi_arch_full_hash\" and will switch to \"full_hash\" in a second step.\n\nLet\u0027s carefully review https://tree.taiga.io/project/tripleo-ci-board/task/1245 together.",
      "range": {
        "startLine": 82,
        "startChar": 142,
        "endLine": 82,
        "endChar": 151
      },
      "revId": "f8f66ed226e7a6010545a31ae63069b636e8c5e1",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a81cb706_6ade1e99",
        "filename": "ci-scripts/container-push/manifest-push.yml",
        "patchSetId": 17
      },
      "lineNbr": 82,
      "author": {
        "id": 192
      },
      "writtenOn": "2019-09-20T08:13:18Z",
      "side": 1,
      "message": "sure, this code is the end result. there is no confusion don\u0027t worry, i am still trying to get this to run via molecule on the local/test registry.\n\nThe change you require is easy to make - i will switch to creating a manifest with a temp name before we merge.",
      "parentUuid": "b927782a_620f48e6",
      "range": {
        "startLine": 82,
        "startChar": 142,
        "endLine": 82,
        "endChar": 151
      },
      "revId": "f8f66ed226e7a6010545a31ae63069b636e8c5e1",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c25982da_379464de",
        "filename": "ci-scripts/infra-setup/roles/promoter/molecule/default/playbook.yml",
        "patchSetId": 17
      },
      "lineNbr": 107,
      "author": {
        "id": 63
      },
      "writtenOn": "2019-09-20T12:43:15Z",
      "side": 1,
      "message": "From this point the tasks should be moved to a different scenario. The current scenario will just test functional test, another scenario will test the manifest push.",
      "revId": "f8f66ed226e7a6010545a31ae63069b636e8c5e1",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d72fb02d_36b93406",
        "filename": "ci-scripts/infra-setup/roles/promoter/molecule/default/playbook.yml",
        "patchSetId": 17
      },
      "lineNbr": 129,
      "author": {
        "id": 502
      },
      "writtenOn": "2019-09-19T17:14:53Z",
      "side": 1,
      "message": "pls move this to teardown.yml, called at the very end",
      "revId": "f8f66ed226e7a6010545a31ae63069b636e8c5e1",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fa13ea9e_d991a1e1",
        "filename": "ci-scripts/infra-setup/roles/promoter/molecule/default/playbook.yml",
        "patchSetId": 17
      },
      "lineNbr": 129,
      "author": {
        "id": 192
      },
      "writtenOn": "2019-09-20T08:13:18Z",
      "side": 1,
      "message": "ack - i have a few more things to cleanup now (things done in main.yaml) but yes it will go in the right place",
      "parentUuid": "d72fb02d_36b93406",
      "revId": "f8f66ed226e7a6010545a31ae63069b636e8c5e1",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f5125339_af2b6ea1",
        "filename": "ci-scripts/infra-setup/roles/promoter/tasks/main.yml",
        "patchSetId": 17
      },
      "lineNbr": 147,
      "author": {
        "id": 63
      },
      "writtenOn": "2019-09-20T10:56:18Z",
      "side": 1,
      "message": "This is is the wrong position for this block. As this is a set of action whose entire purpose is testing, should not be on the main taskset for this role. This should be moved on a teask set on its own and called whn needed, during test runs.",
      "revId": "f8f66ed226e7a6010545a31ae63069b636e8c5e1",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "60128f34_7a6138d3",
        "filename": "ci-scripts/infra-setup/roles/promoter/tasks/main.yml",
        "patchSetId": 17
      },
      "lineNbr": 185,
      "author": {
        "id": 63
      },
      "writtenOn": "2019-09-20T10:56:18Z",
      "side": 1,
      "message": "If I understand correctly, you\u0027re trying to set up a secure registry instead of an insecure, then everything here is needed to make the connection to secure registry possible. Why is it necessary to have the secure registry here ?\nThe tests you create here serve to test the code you can change, not the one you can\u0027t control. If pushing to a secure registry is broken, is there something in the code of this repo that can fix that ?",
      "revId": "f8f66ed226e7a6010545a31ae63069b636e8c5e1",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4151ac70_5b317b99",
        "filename": "ci-scripts/infra-setup/roles/promoter/tasks/main.yml",
        "patchSetId": 17
      },
      "lineNbr": 185,
      "author": {
        "id": 192
      },
      "writtenOn": "2019-09-20T12:50:05Z",
      "side": 1,
      "message": "regarding the \u0027secure\u0027 registry \nthe problem is, when pushing manifests it works fine if you are doing it to \u0027localhost:5000\u0027 or \u0027127.0.0.1:5000\u0027 but as soon as you start trying to use somehting else like an IP address, it needs to be secured.\n\nWe can\u0027t use localhost or 127.0.0.1 because from within the molecule centos vm it 127.0.01 and \u0027localhost\u0027 will reach the centos vm and not the actual registry running on the docker host.",
      "parentUuid": "60128f34_7a6138d3",
      "revId": "f8f66ed226e7a6010545a31ae63069b636e8c5e1",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    }
  ]
}