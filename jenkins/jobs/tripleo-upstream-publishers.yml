# "Building remotely" should always be in the build console output
- publisher:
    name: 'tripleo-upstream-release-node'
    publishers:
        - post-tasks:
            - matches:
                - log-text: Building remotely
              script:
                !include-raw:
                    - scripts/cico-node-done-from-ansible.sh

# "Building remotely" shows up regardless of job status,
# So this publisher should always run.
- publisher:
    name: 'tripleo-upstream-collect-logs'
    publishers:
        - post-tasks:
            - matches:
                - log-text: Building remotely
              script:
                !include-raw:
                    - scripts/tripleo-upstream-collect-logs.sh

- publisher:
    name: 'tripleo-upstream-dlrn-report'
    publishers:
        - post-tasks:
            - matches:
                - log-text: marked build as failure
              script: |
                  export SUCCESS="false"
                  scripts/tripleo-upstream-dlrn-report.sh
        - post-tasks:
            - matches:
                - log-text: congratulations
              run-if-job-successful: true
              script: |
                export SUCCESS="true"
                scripts/tripleo-upstream-dlrn-report.sh
