- job-template:
    name: 'weirdo-stable-{openstack_release}'
    defaults: weirdo-defaults
    description: |
        <h3> Documentation: <a href=http://www.rdoproject.org/>http://www.rdoproject.org/</a> </h3>
        This job runs WeIRDO scenarios against a stable release every two days.
    parameters:
        - string:
            name: release_rpm
            default: 'centos-release-openstack-{openstack_release}'
            description: Release package/RPM used for testing (can also be an URL)
        - string:
            name: version
            default: 'stable/{openstack_release}'
            description: Version of integration tests used (stable/newton, stable/mitaka, etc.)
    triggers:
        - timed: 'H H H/2 * *'
    builders:
        - shell: |
            #!/bin/bash
            echo "+===============================================+"
            echo "| Scheduling jobs to test:"
            echo "|   - release_rpm: $release_rpm"
            echo "|   - version: $version"
            echo "+===============================================+"
        - trigger-builds:
            - project:
                - 'weirdo-generic-puppet-openstack-scenario001'
                - 'weirdo-generic-puppet-openstack-scenario002'
                - 'weirdo-generic-puppet-openstack-scenario003'
                - 'weirdo-generic-packstack-scenario001'
                - 'weirdo-generic-packstack-scenario002'
                - 'weirdo-generic-packstack-scenario003'
              predefined-parameters:
                  release_rpm=$release_rpm
                  version=$version
              block: true
              block-thresholds:
                build-step-failure-threshold: 'FAILURE'
                unstable-threshold: 'FAILURE'
                failure-threshold: 'FAILURE'
    publishers:
        - email:
            recipients: 'rdo-infra-list@redhat.com'

