---
- hosts: instance
  become: true
  tasks:
    - name: "Verify web directory"
      assert:
        that:
          - "{{ web_directory }} == '/var/www/html'"

    - name: "Check if NGINX is installed"
      package_facts:
        manager: auto

    - name: "Verify NGINX is installed"
      assert:
        that: "'nginx' in ansible_facts.packages"

    - name: "Check if toolbox conf is created"
      stat:
        path: "/etc/nginx/conf.d/toolbox.conf"
      register: toolbox_conf

    - name: "Verify toolbox.conf is created"
      assert:
        that: toolbox_conf.stats.exists

    - name: "Check if service is running"
      service_facts:


    - name: "Check if NGINX is running"
      assert:
        that:
          - "'nginx.service' in ansible_facts.services"
          - "{{ ansible_facts.services['nginx.service']['status'] }} == 'running'"
