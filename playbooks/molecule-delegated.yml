---
- hosts: all
  tasks:
    - name: Run role test job
      shell: |-
        # See https://click.palletsprojects.com/en/7.x/python3/
        export LC_ALL=en_US.utf8
        export LANG=en_US.utf8
        export ANSIBLE_LOG_PATH={{ zuul_log_path | default('~/ansible-execution.log') }}

        . {{ ansible_user_dir }}/test-python/bin/activate
        # commands set in job definition vars so this file can be common
        {{ molecule_test_commands }}
      args:
        chdir: "{{ ansible_user_dir }}/{{ zuul.project.src_dir }}/roles/promoter"
        executable: /bin/bash
      changed_when: false
