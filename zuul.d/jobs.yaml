---
- job:
    name: tripleo-ci-promotion-staging-single-pipeline-centos-7
    parent: base
    ansible-version: 2.8
    nodeset: rdo-centos-7
    run: playbooks/staging.yml
    post-run: playbooks/staging-post.yml
    host-vars:
      primary:
        ansible_user: root
    vars:
      pipeline_type: single
      test_release: CentOS-7/master

- job:
    name: tripleo-ci-promotion-staging-integration-pipeline-centos-7
    parent: base
    ansible-version: 2.8
    nodeset: rdo-centos-7
    run: playbooks/staging.yml
    post-run: playbooks/staging-post.yml
    host-vars:
      primary:
        ansible_user: root
    vars:
      pipeline_type: integration
      test_release: CentOS-8/master

# These jobs could be handled by rdo-tox-molecule job, when the pytest-molecule
# supports delegated driver, but as delegated tests don't run in isolation,
# tthey may step on eachother's toe, and the first test could pollute the
# environemnt for the second
# So it's probably better to leave them as standalone jobs

- job:
    name: molecule-provision-promoter-delegated-centos-8
    parent: rdo-tox-molecule-delegated-centos-8
    pre-run: playbooks/molecule-pre.yaml
    vars:
      promoter_user: zuul
      tox_extra_args: -- ci-scripts/infra-setup/roles/promoter/molecule/provision/molecule.yml

- job:
    name: molecule-container-push-delegated-centos-8
    parent: rdo-tox-molecule-delegated-centos-8
    pre-run: playbooks/molecule-pre.yaml
    vars:
      promoter_user: zuul
      tox_extra_args: -- ci-scripts/infra-setup/roles/promoter/molecule/container-push/molecule.yml \
          ci-scripts/infra-setup/roles/promoter/molecule/container-push-secure/molecule.yml \
          ci-scripts/infra-setup/roles/promoter/molecule/container-push-multiarch/molecule.yml \
          ci-scripts/infra-setup/roles/promoter/molecule/container-push-manifest/molecule.yml

- job:
    name: molecule-tripleo-common-delegated-centos-8
    parent: rdo-tox-molecule-delegated-centos-8
    pre-run: playbooks/molecule-pre.yaml
    vars:
      promoter_user: zuul
      tox_extra_args: -- ci-scripts/infra-setup/roles/promoter/molecule/tripleo-common-integration/molecule.yml

- job:
    name: molecule-delegated-promote-images-delegated-centos-8
    parent: rdo-tox-molecule-delegated-centos-8
    pre-run: playbooks/molecule-pre.yaml
    vars:
      promoter_user: zuul
      tox_extra_args: -- ci-scripts/infra-setup/roles/promoter/molecule/provision/molecule.yml
