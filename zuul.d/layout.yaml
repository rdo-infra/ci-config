- job:
    name: tox-jjb
    run: playbooks/tox-jjb-run.yml

#- job:
#    name: rdo-tox-molecule
#    parent: tripleo-tox-molecule
#    nodeset: rdo-fedora-28

- project:
    check:
      jobs:
        - tox-jjb
        - tox-py27: &py27
            success-url: "tox/reports.html"
            failure-url: "tox/reports.html"
            files:
              - ^ci-scripts/infra-.*/.*
              - ^requirements.txt
              - ^test-requirements.txt
              - ^setup.cfg
              - ^setup.py
              - ^tox.ini
              - ^molecule/.*
              - ^playbooks/.*
        - tox-py36: &py36
            success-url: "tox/reports.html"
            failure-url: "tox/reports.html"
            nodeset: rdo-fedora-stable
            files:
              - ^ci-scripts/infra-.*/.*
              - ^requirements.txt
              - ^test-requirements.txt
              - ^setup.cfg
              - ^setup.py
              - ^tox.ini
              - ^playbooks/.*
        - rdo-tox-molecule:
            files:
              - .*molecule.*
              - ^playbooks/.*
              - ^requirements.txt
              - ^test-requirements.txt
              - ^setup.cfg
              - ^setup.py
              - ^tox.ini
              - ^ci-scripts/infra-setup/roles/hubbot/.*
        - rdo-tox-molecule-rhel8:
            # not really needed but enabled as non voting for validating the fact that we can use that job to run on rhel8
            voting: false
            files:
              - .*molecule.*
              - ^playbooks/.*
              - ^requirements.txt
              - ^test-requirements.txt
              - ^setup.cfg
              - ^setup.py
              - ^tox.ini
              - ^ci-scripts/infra-setup/roles/hubbot/.*
    gate:
      jobs:
        - tox-jjb
        - tox-py27:
            <<: *py27
        - tox-py36:
            <<: *py36
