---
- job:
    name: tox-jjb
    run: playbooks/tox-jjb-run.yml

- project:
    templates:
      - jobs-promoter-centos-7-jobs
    check:
      jobs:
        - rdo-tox-molecule: &molecule
            files:
              - .*molecule.*
              - ^ci-scripts/infra-setup/roles/get_hash/.*$
              - ^ci-scripts/infra-setup/roles/promoter/.*$
              - ^requirements.txt
              - ^requirements.txt
              - ^test-requirements.txt
              - ^tox.ini$
              - ^zuul.d/layout.yaml
            vars:
              tox_environment:
                PYTEST_REQPASS: 1
        - rdo-tox-molecule-delegated-centos-8:
            <<: *molecule
            vars:
              tox_environment:
                PYTEST_REQPASS: 1
        - tox-jjb
        - tox-py27-ci-config: &py27
            files: &pyfiles
              - .*\.py
              - .*\.ini
              - ^ci-scripts/infra-.*/.*
              - ^molecule/.*
              - ^playbooks/.*
              - ^requirements.txt
              - ^setup.cfg
              - ^setup.py
              - ^test-requirements.txt
              - ^tox.ini
              - ^zuul.d/layout.yaml$
        - tox-py36-ci-config: &py36
            files: *pyfiles
    gate:
      jobs:
        - rdo-tox-molecule:
            <<: *molecule
        - rdo-tox-molecule-delegated-centos-8:
            <<: *molecule
        - tox-jjb
        - tox-py27-ci-config:
            <<: *py27
        - tox-py36-ci-config:
            <<: *py36
